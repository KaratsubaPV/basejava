<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.12" DotMatrixReport="False" EngineOptions.DoublePass="True" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Ïî óìîë÷àíèþ" PrintOptions.PrintOnSheet="0" PrintOptions.ShowDialog="False" ReportOptions.CreateDate="38735,5581839468" ReportOptions.Description.Text="" ReportOptions.LastChange="42489,4473874537" ScriptLanguage="PascalScript" ScriptText.Text="var Stream: Char;  &#13;&#10;procedure PDF4171OnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;       s:String;&#13;&#10;       numPolis:String;&#13;&#10;       i :Integer;&#13;&#10;       sTmp: String;&#13;&#10;       FIO: String;&#13;&#10;       FIObin: String;&#13;&#10;       Index: Integer;                                        &#13;&#10;       IndexD: Integer;            &#13;&#10;       sDays: string;&#13;&#10;       myDate : TDateTime;                                              &#13;&#10;begin&#13;&#10;       myDate := EncodeDate(1900, 01, 01);    &#13;&#10;       IndexD:=0;                                                                &#13;&#10;       numpolis:= Format('%x', [&#60;numpolis&#62;]);                                          &#13;&#10;       s:= chr(2)+chr(0);&#13;&#10;       IndexD:=2;                             &#13;&#10;       for i:=0 to (Length(numPolis) div 2)-1 do&#13;&#10;       begin&#13;&#10;         sTmp:= '$'+Copy(numPolis, i*2+1, 2);&#13;&#10;         s:=s+chr(StrToInt(sTmp));&#13;&#10;         Inc(IndexD);                       &#13;&#10;       end;&#13;&#10;       FIO:= '';                         &#13;&#10;       FIO:= VarToStr(&#60;fio&#62;);&#13;&#10;&#13;&#10;       fioBin:='';                                &#13;&#10;       sTmp:='';&#13;&#10;       for i:=1 to Length(FIO) do&#13;&#10;       begin&#13;&#10;          fioBin:= fioBin+getByteBySymbol(fio[i]);&#13;&#10;          sTmp:=sTmp+FIO[i];&#13;&#10;       end;&#13;&#10;                                                       &#13;&#10;       Index:= Length(fioBin) div 4;&#13;&#10;       sTmp:= '';                              &#13;&#10;       for i:=0 to 300 do&#13;&#10;       begin&#13;&#10;         if (i&#60;Index+1) then&#13;&#10;         begin&#13;&#10;          if ((i mod 2)=0) and (sTmp&#60;&#62;'')  then&#13;&#10;          begin&#13;&#10;            s:=s+chr(StrToInt('$'+sTmp));&#13;&#10;            Inc(IndexD);&#13;&#10;            stmp:= '';&#13;&#10;          end;&#13;&#10;          sTmp:= sTmp+BinToHexM(Copy(FIObin, i*4+1, 4));&#13;&#10;         end&#13;&#10;         else&#13;&#10;         begin&#13;&#10;          s:=s+chr(0);&#13;&#10;          Inc(IndexD);&#13;&#10;          if (IndexD=60) then break;&#13;&#10;         end;&#13;&#10;       end;                            &#13;&#10;       s:=s+chr(&#60;pol&#62;);&#13;&#10;       sDays:= Format('%x', [&#60;koldays&#62;]);&#13;&#10;                                                                     &#13;&#10;       for i:=0 to (Length(sDays) div 2)-1 do&#13;&#10;       begin&#13;&#10;         sTmp:= '$'+Copy(sDays, i*2+1, 2);&#13;&#10;         s:=s+chr(StrToInt(sTmp));&#13;&#10;         Inc(IndexD);                       &#13;&#10;       end;&#13;&#10;       Inc(IndexD);&#13;&#10;       s:= s + '00SERVICECARD'; // 00 - òóò ïîèäåå äîëæåí áûòü ñðîê äåéñòâèÿ ïîëèñà, íî ïî÷åìó-òî îí òóò â êîäå íå óïîìèíàåòñÿ. Îñòàâëÿåì åãî ïóñòûì                                                                                                                                                                                                                                                              &#13;&#10;       IndexD:=IndexD + 13;                                                                                &#13;&#10;       for i:=0 to 200 do&#13;&#10;       begin&#13;&#10;         if (IndexD&#60;130) then&#13;&#10;         begin&#13;&#10;           s:=s+chr(0);&#13;&#10;           Inc(IndexD);                         &#13;&#10;         end else Break;                                             &#13;&#10;       end; &#13;&#10;       pdfCode.Text:= s;&#13;&#10;&#13;&#10;      memoDb.text:= DateToStr(myDate+&#60;koldays&#62;);          &#13;&#10;      FIO:= VarToStr(&#60;fio&#62;);&#13;&#10;      memoFam.text:= Copy(FIO,1,pos('|',FIO)-1);&#13;&#10;      FIO:= Copy(FIO,pos('|',FIO)+1,500);&#13;&#10;      memoName.text:=Copy(FIO, 1, pos('|',FIO)-1);&#13;&#10;      FIO:= Copy(FIO,pos('|',FIO)+1,500);&#13;&#10;      memoOtch.text:= FIO;&#13;&#10;&#13;&#10;      sTmp:= VarToStr(&#60;numpolis&#62;);&#13;&#10;      s:='';                                             &#13;&#10;      for i:=1 to Length(sTmp) do&#13;&#10;      begin&#13;&#10;         s:= s+sTmp[i];&#13;&#10;         if (i mod 4)=0 then s:=s+' ';                                                              &#13;&#10;      end;&#13;&#10;      memoenp.text:= s;&#13;&#10;      if &#60;pol&#62;=1 then memoPol.text:= 'Ì' else memoPol.text:= 'Æ';&#13;&#10;      //eanbc.text:= &#60;eancode&#62;;&#13;&#10;      //sTmp:= &#60;eancode&#62;;&#13;&#10;&#13;&#10;      memoPolBegin.Text:= &#60;polbegin&#62;;&#13;&#10;      memoPolEnd.Text := &#60;polend&#62;;&#13;&#10;      memoCardNum.Text := &#60;cardnum&#62;;                                &#13;&#10;end;&#13;&#10;    &#13;&#10;function BinToHexM(str: String): string;&#13;&#10;var&#13;&#10;  Bin: array [0..15] Of String;&#13;&#10;  Hex: array [0..15] Of Char;&#13;&#10;  i: integer;                                   &#13;&#10;begin&#13;&#10;   bin[0]:='0000';  hex[0]:='0';                    &#13;&#10;   bin[1]:='0001';  hex[1]:='1';  &#13;&#10;   bin[2]:='0010';  hex[2]:='2';  &#13;&#10;   bin[3]:='0011';  hex[3]:='3';  &#13;&#10;   bin[4]:='0100';  hex[4]:='4';  &#13;&#10;   bin[5]:='0101';  hex[5]:='5';  &#13;&#10;   bin[6]:='0110';  hex[6]:='6';  &#13;&#10;   bin[7]:='0111';  hex[7]:='7';  &#13;&#10;   bin[8]:='1000';  hex[8]:='8';  &#13;&#10;   bin[9]:='1001';  hex[9]:='9';  &#13;&#10;   bin[10]:='1010';  hex[10]:='A';  &#13;&#10;   bin[11]:='1011';  hex[11]:='B';  &#13;&#10;   bin[12]:='1100';  hex[12]:='C';  &#13;&#10;   bin[13]:='1101';  hex[13]:='D';  &#13;&#10;   bin[14]:='1110';  hex[14]:='E';  &#13;&#10;   bin[15]:='1111';  hex[15]:='F';&#13;&#10;   for i:=0 to Length(Bin)-1 do&#13;&#10;   begin&#13;&#10;     if (str=bin[i]) then&#13;&#10;     begin&#13;&#10;       result:= hex[i];&#13;&#10;       break;                     &#13;&#10;     end;                            &#13;&#10;   end;             &#13;&#10;end;          &#13;&#10;  &#13;&#10;function getByteBySymbol(ch: string):string;&#13;&#10;var&#13;&#10;  code: array[1..49,1..49] of string;&#13;&#10;  i: Integer;&#13;&#10;begin&#13;&#10;  code[1,1]:=' '; code[1,2]:='000000';&#13;&#10;  code[2,1]:='.'; code[2,2]:='000001';&#13;&#10;  code[3,1]:='-'; code[3,2]:='000010';&#13;&#10;  code[4,1]:=''''; code[4,2]:='000011';&#13;&#10;  code[5,1]:='0'; code[5,2]:='000100';&#13;&#10;  code[6,1]:='1'; code[6,2]:='000101';&#13;&#10;  code[7,1]:='2'; code[7,2]:='000110';&#13;&#10;  code[8,1]:='3'; code[8,2]:='000111';&#13;&#10;  code[9,1]:='4'; code[9,2]:='001000';&#13;&#10;  code[10,1]:='5'; code[10,2]:='001001';&#13;&#10;  code[11,1]:='6'; code[11,2]:='001010';&#13;&#10;  code[12,1]:='7'; code[12,2]:='001011';&#13;&#10;  code[13,1]:='8'; code[13,2]:='001100';&#13;&#10;  code[14,1]:='9'; code[14,2]:='001101';&#13;&#10;  code[15,1]:='À'; code[15,2]:='001110';&#13;&#10;  code[16,1]:='Á'; code[16,2]:='001111';&#13;&#10;  code[17,1]:='Â'; code[17,2]:='010000';&#13;&#10;  code[18,1]:='Ã'; code[18,2]:='010001';&#13;&#10;  code[19,1]:='Ä'; code[19,2]:='010010';&#13;&#10;&#13;&#10;  code[20,1]:='Å'; code[20,2]:='010011';&#13;&#10;  code[21,1]:='¨'; code[21,2]:='010100';&#13;&#10;  code[22,1]:='Æ'; code[22,2]:='010101';&#13;&#10;  code[23,1]:='Ç'; code[23,2]:='010110';&#13;&#10;  code[24,1]:='È'; code[24,2]:='010111';&#13;&#10;  code[25,1]:='É'; code[25,2]:='011000';&#13;&#10;  code[26,1]:='Ê'; code[26,2]:='011001';&#13;&#10;  code[27,1]:='Ë'; code[27,2]:='011010';&#13;&#10;  code[28,1]:='Ì'; code[28,2]:='011011';&#13;&#10;  code[29,1]:='Í'; code[29,2]:='011100';&#13;&#10;  code[30,1]:='Î'; code[30,2]:='011101';&#13;&#10;  code[31,1]:='Ï'; code[31,2]:='011110';&#13;&#10;  code[32,1]:='Ð'; code[32,2]:='011111';&#13;&#10;  code[33,1]:='Ñ'; code[33,2]:='100000';&#13;&#10;  code[34,1]:='Ò'; code[34,2]:='100001';&#13;&#10;  code[35,1]:='Ó'; code[35,2]:='100010';&#13;&#10;  code[36,1]:='Ô'; code[36,2]:='100011';&#13;&#10;  code[37,1]:='Õ'; code[37,2]:='100100';&#13;&#10;  code[38,1]:='Ö'; code[38,2]:='100101';&#13;&#10;&#13;&#10;  code[39,1]:='×'; code[39,2]:='100110';&#13;&#10;  code[40,1]:='Ø'; code[40,2]:='100111';&#13;&#10;  code[41,1]:='Ù'; code[41,2]:='101000';&#13;&#10;  code[42,1]:='Ü'; code[42,2]:='101001';&#13;&#10;  code[43,1]:='Ú'; code[43,2]:='101010';&#13;&#10;  code[44,1]:='Û'; code[44,2]:='101011';&#13;&#10;  code[45,1]:='Ý'; code[45,2]:='101100';&#13;&#10;  code[46,1]:='Þ'; code[46,2]:='101101';&#13;&#10;  code[47,1]:='ß'; code[47,2]:='101110';&#13;&#10;  code[48,1]:='?'; code[48,2]:='101111';&#13;&#10;  code[49,1]:='|'; code[49,2]:='111111';&#13;&#10;&#13;&#10;  result:= '000000';&#13;&#10;  for i:=1 to 50 do&#13;&#10;  begin&#13;&#10;    if (i=50) then Break;&#13;&#10;    if (code[i,1]=ch) then&#13;&#10;    begin&#13;&#10;      result:= code[i,2];&#13;&#10;      Break;&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;end;            &#13;&#10;&#13;&#10;&#13;&#10;begin&#13;&#10;// Picture1.Picture.LoadFromFile('C:\Photo.jpg');  &#13;&#10;end." OnStartReport="frxReport_OnBeforePrint" PropData="044C65667403800003546F7002180844617461736574730100095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
  <TfrxReportPage Name="pgReport" Orientation="poLandscape" PaperWidth="86" PaperHeight="54" PaperSize="256" LeftMargin="0" RightMargin="0" TopMargin="0" BottomMargin="0" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxMemoView Name="memoFam" Left="18,8976378" Top="130,4488189" Width="147,40143079" Height="15,11812" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="Ð˜Ð²Ð°Ð½Ð¾Ð²"/>
    <TfrxMemoView Name="memoName" Left="18,8976378" Top="144,2992126" Width="147,40143079" Height="15,11812" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="Ð˜Ð²Ð°Ð½"/>
    <TfrxMemoView Name="memoOtch" Left="18,8976378" Top="158,34645669" Width="128,50378079" Height="15,11812" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="Ð˜Ð²Ð°Ð½Ð¾Ð²Ð¸Ñ‡"/>
    <TfrxMemoView Name="memoDb" Left="18,8976378" Top="172,33070866" Width="60,47224079" Height="15,11812" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="01.01.1980"/>
    <TfrxPDF417 Name="pdfCode" Left="54,80314961" Top="57,26770921" Width="215,43302693" Height="52,91339559" OnBeforePrint="PDF4171OnBeforePrint" ShowHint="True" AlignH="ahCenter" AlignV="avCenter" Color="16777215" CompactionMode="cmAuto" CompactPDF="True" DataColumns="10" DataRows="15" DrawMethod="dmRastr" ErrorCorrectionLevel="ecl4" ForeColor="0" FreezeEncode="False" ModuleSize="1" YXRatio="3"/>
    <TfrxMemoView Name="memoPol" Left="82,59055118" Top="172,33070866" Width="26,45647079" Height="15,11812" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="Ð–"/>
    <TfrxMemoView Name="memoenp" Left="18,8976378" Top="15,1181102362205" Width="287,24409449" Height="26,45671" ShowHint="False" DisplayFormat.DecimalSeparator="," Font.Charset="0" Font.Color="-16777208" Font.Height="-24" Font.Name="Square721 BT" Font.Style="0" ParentFont="False" Text="0000 0000 0000 0000"/>
    <TfrxMemoView Name="Memo2" Left="18,89765" Top="45,9133663" Width="287,24409449" Height="12,59843333" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="ÐÐžÐœÐ•Ð   ÐŸÐžÐ›Ð˜Ð¡Ð  ÐžÐ‘Ð¯Ð—ÐÐ¢Ð•Ð›Ð¬ÐÐžÐ“Ðž ÐœÐ•Ð”Ð˜Ð¦Ð˜ÐÐ¡ÐšÐžÐ“Ðž Ð¡Ð¢Ð ÐÐ¥ÐžÐ’ÐÐÐ˜Ð¯"/>
    <TfrxMemoView Name="Memo3" Left="169,85826283" Top="129,41732283" Width="138,58276667" Height="11,33858024" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Ð”Ð°Ñ‚Ð° Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð² Ð¡ÐœÐž:"/>
    <TfrxMemoView Name="memoPolBegin" Left="178,41727402" Top="138,36220472" Width="129,76386333" Height="15,11811024" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="01.01.2016"/>
    <TfrxMemoView Name="Memo5" Left="208,43310504" Top="150,60629921" Width="79,37013" Height="15,11812" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="Ð¡Ñ€Ð¾Ðº Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ:"/>
    <TfrxMemoView Name="memoPolEnd" Left="235,11039" Top="159,7007874" Width="73,07091333" Height="15,11811024" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Ð½Ðµ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½"/>
    <TfrxMemoView Name="Memo8" Left="142,38582677" Top="173,79527559" Width="50,39373333" Height="15,11811024" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="â„– ÐºÐ°Ñ€Ñ‚Ñ‹:"/>
    <TfrxMemoView Name="memoCardNum" Left="193,05524667" Top="173,79527559" Width="115,90558667" Height="15,11811024" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="86 003 303 0000000"/>
    <TfrxLineView Name="Line1" Left="7,55906" Top="111,3859" Width="309,92146" Height="0" ShowHint="False" Diagonal="True"/>
  </TfrxReportPage>
</TfrxReport>
